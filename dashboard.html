<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MentorLoop EDU | Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: Arial, Helvetica, sans-serif;
      background: #f3f4f6;
      padding: 30px;
    }
    .card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
      box-shadow: 0 6px 15px rgba(0,0,0,0.1);
    }
    button {
      padding: 10px 14px;
      margin-top: 10px;
      background: #2563eb;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.95rem;
    }
    input, select, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
    }
    .ai-box {
      background: #eef2ff;
      padding: 15px;
      border-radius: 10px;
      margin-top: 10px;
    }
    .logout {
      background: #dc2626;
    }
    .report {
      background: #fef2f2;
      border-left: 5px solid #dc2626;
    }
    .small {
      font-size: 0.85rem;
      color: #6b7280;
    }
  </style>
</head>
<body>

<h1>MentorLoop EDU Dashboard</h1>

<!-- PROFILE -->
<div class="card">
  <p><strong>Name:</strong> <span id="userName"></span></p>
  <p><strong>Points:</strong> <span id="points"></span></p>
</div>

<!-- BADGES -->
<div class="card">
  <h2>Your Badges</h2>
  <ul id="badges"></ul>
</div>

<!-- ACTIONS -->
<div class="card">
  <h2>Actions</h2>
  <button onclick="goAsk()">Ask a Doubt</button><br>
  <button onclick="goHelp()">Help Another Student</button><br>
  <button class="logout" onclick="logout()">Logout</button>
</div>

<!-- AI GUIDE -->
<div class="card">
  <h2>ü§ñ MentorLoop AI Guide</h2>
  <input id="aiInput" placeholder="Ask me what to do..." />
  <button onclick="aiRespond()">Ask AI</button>
  <div class="ai-box" id="aiResponse"></div>
</div>

<!-- SAFE PLAY REPORTING -->
<div class="card report">
  <h2>üö® Report a Problem (Fair Play)</h2>
  <p class="small">
    Use this only if you see misuse, bullying, spam, or unsafe behavior.
  </p>

  <select id="reportReason">
    <option value="">Select reason</option>
    <option>Bullying or harassment</option>
    <option>Spam or irrelevant content</option>
    <option>Inappropriate language</option>
    <option>Cheating or misuse</option>
    <option>Other</option>
  </select>

  <textarea id="reportDetails" placeholder="Optional details (what happened?)"></textarea>

  <button onclick="submitReport()">Submit Report</button>
</div>

<script>
/* üîê PROTECTION */
const user = localStorage.getItem("ml_user");
if (!user) {
  window.location.href = "ask-doubt.html";
}

/* üë§ USER DATA */
document.getElementById("userName").textContent = user;
const points = parseInt(localStorage.getItem("ml_points") || "0");
document.getElementById("points").textContent = points;

/* üèÖ BADGES */
const badges = document.getElementById("badges");
if (points >= 10) badges.innerHTML += "<li>Helper üü¢</li>";
if (points >= 30) badges.innerHTML += "<li>Mentor üîµ</li>";
if (points >= 50) badges.innerHTML += "<li>Legend üü£</li>";

/* üîÅ NAVIGATION */
function goAsk() {
  window.location.href = "ask-doubt.html";
}
function goHelp() {
  window.location.href = "questions.html";
}
function logout() {
  localStorage.clear();
  window.location.href = "index.html";
}

/* ü§ñ AI GUIDE */
function aiRespond() {
  const input = document.getElementById("aiInput").value.toLowerCase();
  const box = document.getElementById("aiResponse");

  if (input.includes("ask")) {
    box.innerHTML = "üìò Click <b>Ask a Doubt</b> to share your question.";
  } else if (input.includes("help")) {
    box.innerHTML = "ü§ù Click <b>Help Another Student</b> to answer questions.";
  } else if (input.includes("points")) {
    box.innerHTML = "‚≠ê Earn points by helping others. More points = more badges.";
  } else if (input.includes("report")) {
    box.innerHTML = "üö® Use the <b>Report a Problem</b> section to maintain fair play.";
  } else if (input.includes("logout")) {
    box.innerHTML = "üö™ Click the red <b>Logout</b> button to exit.";
  } else {
    box.innerHTML = "ü§î Try asking: <i>'How do I help?' or 'How do I report misuse?'</i>";
  }
}

/* üö® REPORT SYSTEM */
function submitReport() {
  const reason = document.getElementById("reportReason").value;
  const details = document.getElementById("reportDetails").value;

  if (!reason) {
    alert("Please select a reason");
    return;
  }

  let reports = JSON.parse(localStorage.getItem("ml_reports")) || [];

  reports.push({
    reportedBy: user,
    reason: reason,
    details: details,
    time: new Date().toLocaleString()
  });

  localStorage.setItem("ml_reports", JSON.stringify(reports));

  alert("Report submitted. Thank you for keeping MentorLoop EDU safe.");
  document.getElementById("reportReason").value = "";
  document.getElementById("reportDetails").value = "";
}
</script>

</body>
</html>
